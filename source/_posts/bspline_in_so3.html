---
title: B-Spline in Space
date: 2020-03-2 
mathjax: true
tags:
---
<head>
    <script type="text/javascript" async
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
        </script>
        <style>
            .bib ol { counter-reset: item }
            .bib li { display: block ; counter-increment: item; }
            .bib li:before { content: " ["counter(item)"] "; }
        </style>
</head>

<body>
    <h2>Motivation</h2>
    <p>In a robot system, tens of sensors collecting data in different frequencies and phases.
        When intermediate values between samples are required, linear interpolation can be used to approximate these values according
        to their surrounding samples. In some cases, however, linear interpolation is not qualified due to its 
        lack of continuity in high order derivatives. 
    </p>
    <p>
        Moreover, in robotics, computer graphics and computer vision, physical values are not only expressed in Euclidean Space.
        The orientation of a digital object, the pose of a automatic robot, are described by Quaternion or Lie Group. 
        Some of the readers may have heard about Quaternion SLERP (Spherical Linear Interpolation), which is a general 
        method used in Quaternion interpolation. But SLERP only keeps the intermediate quaternion unit, 
        the derivative continuity before and after a knot is not guaranteed. 
    </p>
    <p>
        With but not limited to the reasons above, B-Spline is widely used in industry and research. 
        Here is a introduction to the principle of B-Spline, both in Euclidean Space and Lie Group.
    </p>
    <h2>B-Spline in Euclidean Space</h2>
    <table style="min-width: 6in;">
        <col width="20%">
        <col width="15%">
        <col width="65%">
        <tr>
            <th>Terminologies</th>
            <th>Notation</th>
            <th>Explanation</th>
        </tr>
        <tr>
            <td>Independent Variable</td>
            <td>\(t\)</td>
            <td>In state estimation, the independent variable is time \(t\).</td>
        </tr>
        <tr>
            <td>Order</td>
            <td>\(n\)</td>
            <td>Same as the order of final polynomial, the highest exponent.For instance, \(f(x) = 3x^3\) has an order of 4.</td>
        </tr>
        <tr>
            <td>Degree</td>
            <td>\(p\)</td>
            <td>Same as the degree of final polynomial, the highest exponent.For instance, \(f(x) = 3x^3\) has a degree of 3.</td>
        </tr>
        <tr>
            <td>Segment Index</td>
            <td>\(i\)</td>
            <td>A B-Spline is combined with piecewise polynomial, each piece is a segment.</td>
        </tr>
        <tr>
            <td>Knot Vector</td>
            <td>\(k\)</td>
            <td>
                The connect knot, or joint, between every piece of polynomial segment.
                Knot vector lies in the axis of independent variable \(t\).
            </td>
        </tr>
        <tr>
            <td>Basis Function</td>
            <td>\(B_{i,p}(t)\)</td>
            <td>In the expression, \(i\) is the index of polynomial segment, \(p\) is the degree of the basis function.</td>
        </tr>
        <tr>
            <td>Control Points</td>
            <td>\(C_i\)</td>
            <td>Also named as coefficients. Control points are used to describe the weight of each piece of polynomial segment.</td>
        </tr>
    </table>
    <h3>Intuitive Understanding from Figures</h3>

    <figure>
        <img src="/2020/03/02/bspline_in_so3/viz_bspline.svg" style="width:100%">
        <figcaption>
            Fig.1 - The point \(P_{0,2}\) of basis function \(B_{0,2}(t)\) (degree 2 and segment 0), is evaluated by 
            the weighted combination of \(B_{0,1}(t)\) and \(B_{1,1}(t)\). The <b>weight</b> of each component is 
            defined by the distance between \(P_{0,2}\) and its correspondent knot points. 
            As shown in the figure, the knot vector is \([0, 3, 6, 9]^\top\).
        </figcaption>
    </figure>

    <figure>
        <img src="/2020/03/02/bspline_in_so3/viz_ctrlpt.svg" style="width:100%">
        <figcaption>
            Fig.2 - A B-Spline with degree 2, named \(S_2(t)\) is generated by weighted combinations of all its 
            basis functions. The weight comes from control points, which are \([1.2, 0.8, 1.1, 1.2, 1.1]\) in the figure.
            The brown dash lines show how control point affect the weight of basis function,
            these lines finally compose the brown spline.
            The knot vector is \([0, 1, 2, 3, 4, 5, 6, 7]^\top\).
        </figcaption>
    </figure>
    <h3>Cox-de Boor Recursion Formula</h3>
    <p>A mathematical representation of B-Spline is necessary after the intuitive concept.</p>
    <p>
        Let \(K\) be a set of \(m\) non-decreasing numbers, \(k_0 \le k_1 \le \cdots \le k_{m-1} \). 
        The \(k_i\)s are called knots, the set \(K\) the knot vector, 
        and the half-open interval \([k_i, k_{i+1})\) the i-th knot span. 
        Note that since some \(k_i\)s may be equal, some knot spans may not exist. 
        If the knots are equally spaced (i.e., \(k_{i+1} - k_i\) is a constant for \((0 \le i \le m - 1)\), 
        the knot vector or the knot sequence is said uniform; otherwise, it is non-uniform<sup>[1]</sup>.
    </p>
    <p>
        The i-th B-spline basis function of degree \(p\), written as \(B_{i,p}(t)\), is defined recursively as follows:
    </p>
    \[
        B_{i,0}(t) = 
        \begin{cases}
        1 & \text{if} \ \ t_i \le t < t_{i+1} \\
        0 & \text{otherwise}
        \end{cases}
        \tag{2-1}
    \]

    \[
        B_{i,p}(t) = 
        \frac{t - t_i}{t_{i+p} - t_i} B_{i,p-1}(t) + 
        \frac{t_{i+p+1} - t}{t_{i+p+1} - t_{i+1}} B_{i+1,p-1}(t)
        \tag{2-2}
    \]
    
    <h2>References</h2>
    <ol class="bib">
        <li>Kim, M.J., Kim, M.S. and Shin, S.Y., 1995, September.
            <cite>
                A general construction scheme for unit quaternion curves with simple high order derivatives.        
            </cite>
            In Proceedings of the 22nd annual conference on Computer graphics and interactive techniques (pp. 369-376).
        </li>
        <li>
            Qin, Kaihuai, 
            <cite>
                <a href="/2020/03/02/bspline_in_so3/general_matrix_representation_for_bsplines.pdf">
                    General matrix representations for B-splines
                </a>
            </cite>
                , The Visual Computer (2000) 16:177â€“186
        </li>
        <li>Shene,<a href="https://pages.mtu.edu/~shene/COURSES/cs3621/NOTES/spline/B-spline/bspline-basis.html">
            B-spline Basis Functions: Definition</a>
        </li>
    </ol>

      
</body>
